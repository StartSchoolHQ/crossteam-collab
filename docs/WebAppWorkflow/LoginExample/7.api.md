---
title: "The API Call"
description: "Cross Team Collaboration"
id: 7-api
---

```js
function loginUser(email, password) {
    fetch('https://api.yourapp.com/login', {
        method: 'POST',              
        headers: {
            'Content-Type': 'application/json'  
        },
        body: JSON.stringify({      
            email: email,
            password: password
        })
    })
    .then(response => response.json()) 
    .then(data => {
        
        if (data.success) {
            document.getElementById('message').innerHTML = 
                '<p style="color: green;">Login successful!</p>';
            
            localStorage.setItem('sessionToken', data.sessionToken);
            
            setTimeout(() => {
                window.location.href = '/dashboard';
            }, 1000);
        } else {
            document.getElementById('message').innerHTML = 
                '<p style="color: red;">' + data.error + '</p>';
        }
    })
    .catch(error => {
        document.getElementById('message').innerHTML = 
            '<p style="color: red;">Connection error. Please try again.</p>';
        console.error('Error:', error);
    });
}
```

### Questions to explore in the code

**Understanding the Request:**

1. What does `fetch()` mean in this code?
2. What URL is the login request being sent to?
3. What HTTP method is used and what data is being sent?
4. Why does the request include a 'Content-Type' header?

**Handling the Response:**

5. How does the code determine if login was successful or failed?
6. What information does the server send back in the response?
7. What happens to the user after a successful login?

**Session Management:**

8. What is a session token and where is it stored?
9. Why is the session token saved after login?

**Error Handling:**

10. What's the difference between a failed login and a network error?
11. When would the `.catch()` block execute instead of the `.then()` block?

**User Experience:**

12. What visual feedback does the user receive for success vs. errors?
13. Why does the code wait 1 second before redirecting to the dashboard?

**Async Behavior:**

14. Why does the code use `.then()` instead of running everything immediately?