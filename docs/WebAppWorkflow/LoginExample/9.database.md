---
title: "Database Interaction"
description: "Cross Team Collaboration"
id: 9-database
---

```sql
-- Users Table
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Sessions Table
CREATE TABLE sessions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    token VARCHAR(255) UNIQUE NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### Sample Data

#### USERS TABLE

| id  | email             | password_hash       | created_at          |
|-----|------------------|-------------------|-------------------|
| 1   | alice@example.com | `a1b2c3d4e5f6...` | 2024-01-15 10:30:00 |
| 2   | bob@example.com   | `x9y8z7w6v5u4...` | 2024-02-20 14:15:00 |

#### SESSIONS TABLE

| id  | user_id | token          | expires_at          | created_at          |
|-----|---------|----------------|-------------------|-------------------|
| 1   | 1       | `7f3a9b2c...`  | 2024-12-04 10:30:00 | 2024-12-03 10:30:00 |
| 2   | 1       | `9d8e7f6g...`  | 2024-12-05 14:20:00 | 2024-12-04 14:20:00 |
| 3   | 2       | `5h4i3j2k...`  | 2024-12-06 09:15:00 | 2024-12-05 09:15:00 |

### Example Queries

```sql
-- Query 1
SELECT id, email, password_hash 
FROM users 
WHERE email = 'alice@example.com';
-- Result:
-- id=1, email='alice@example.com', password_hash='a1b2c3d4e5f6...'


-- Query 2
INSERT INTO sessions (user_id, token, expires_at)
VALUES (1, '7f3a9b2c...', '2024-12-04 10:30:00');
-- Result:
-- New session created with id=1


-- Query 3
SELECT * 
FROM sessions 
WHERE user_id = 1;
-- Result:
-- Returns sessions with id=1 and id=2 (both belong to alice)
```

### Questions to explore in the code:

1. What are the two main tables in this database and what do they store?
2. What fields are required when creating a new user in the users table?
3. Looking at the sample data, which user (alice or bob) has more sessions?
4. Why is the token field marked as UNIQUE in the sessions table?
5. In Query 1, what information is being retrieved about the user?
6. Write a query to find all sessions that belong to bob@example.com (user_id = 2)